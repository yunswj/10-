

# 问题分析1

正常吸气的阻力分为两部分，弹性阻力占 $70%$ 和 $30%$ 为非弹性阻力。而题中关注的气道阻力属于非弹性阻力，占 $80%$ 。按照阻力产生的不同原因分为以下两种，在后方括号给出贡献的大小：  

1.组织阻力 $10%$ 
2.气道阻力 $90%$ 

气体分子以及气体分子与管壁之间的阻力占了 $80\% ·\sim 90\%%$ .为了问题研究的简便性，以及组织阻力对最终的阻力贡献很少。所以在非弹性阻力段只考虑气道阻力，不考虑组织阻力。虽然线性模型的求解简便，但是它描述不了复杂呼吸系统的行为特性。呼吸道内的气流形式很复杂，不能以最简单的层流去分析计算。



![image-20211206183820998](C:\Users\yunswj\Desktop\mathmodel.assets\image-20211206183820998.png)

![image-20211206183832213](C:\Users\yunswj\Desktop\mathmodel.assets\image-20211206183832213.png)





## 模型假设：

1.气道上缘是刚性的圆管。  
2.支气管树是一个自上而下气道直径逐渐减小的树状结构.  
3.按照解剖学结果，支气管树的分级为 $23$ 级。    
4.大气道不宜变形。     
5.小气道的横截半径均小于 $2mm$，且内部的气流形式为层流。  
6.健康男性生理数据，$K _1 = 0.34 cm ~ H _2O*S/L$ , $K _2 = 0.46 cm ~ H _2O*S/L$   
7.CFD计算中出口边界的相对压力值取 $0$.  
8.计算时均使用 $cm,g,s$ 单位制.  
9.本文研究支气管流道的三维分叉及弯曲对流动的影响，在几何模型生成时使用光滑圆柱来表示。

## 建模

根据气管的解剖结构将整个呼吸道分为三级-有软骨支撑的大气道，没有软骨支撑的陷闭气道和小气道三部分。   



<img src="C:\Users\yunswj\Desktop\mathmodel.assets\image-20211206183747794.png" alt="image-20211206183747794" style="zoom:30%;" />

### 1.上气道Rohrer形式气流阻力描述  
根据假设上气道是刚性软骨管，那么使用 $Rohrer$ 形式描述气流阻力， 换句话说上气道的力学特性是呼吸过程中不易变形的大口径气道。.气道阻力表达式是： $$P=R _1 \times Q +R _2 \times Q|Q|$$  

其中 $K _1$ 和 $K _2$ 是常数，与气道的几何尺寸，气体粘度，气体密度有关。  

#### 2.陷闭气道  

部分气道不含软骨，在外面的透壁压接近0的时候横截面积缩小，易发生气道陷闭，这部分具有弹性的气道称为陷闭气道。其内部阻力由气流阻力和弹性阻力构成，两个函数在表达形式上与肺内空气含量有关。 它们的直径随着跨壁压的变化而扩张收缩，但长度变化不明显。因此，这些气道假设为一个体积 $(V _c)$ 随其跨壁压 $(P _c)$ 变化的定长弹性圆柱管道。气道弹性为：$$P _c=b - {\frac{1}{a}}ln(\frac{V _cmax}{V _c}-0.999)$$ 其中a,b是常数。依据气道的 $P _c-V _c$ 曲线拟合得到 $a = 0.35cm H _2O ^{-1}$ , $b=2cm H _2O$ 。陷闭气道的气阻 $(R _c)$ 如下所示：$$R _c = K _3(\frac{V _cmax}{V _c}) ^2$$  其中,$K _3$ 是常数 代表 $V _c$ 达到最大值 $V _cmax$ 时陷闭气道的气阻。 $K _3$ $V _cmax$ $0.21 _{cm}~H_2O*S/L,0.15L$

#### 3.小气道  

肺内16~23 节的支气管均被成为小气道且横截面积小，所以内部气流近视为层流。小气道的气阻 (R _s) 随肺内气体体积(V _A) 呈现指数变化：$$R _s=B _s + A _s \times exp(\frac{K _s(V _A - RV)}{VC})$$. 其中 $K _s,B _s,A _s,VC,RV$ 均是常数，$VC$ 代表肺活量，$RV$ 代表肺内残气量。根据文献所给的 $R _s$ 随 $V _A$ 的变化曲线，拟合得到 $A _s = 10 cm H _2 o*S /L，B _s = 0.2cm~ H _2*S/L,K _s = -10$ 依据健康的男性生理数据，分别为 $VC$ , $RV$ 取值  $3.95 L$ , $1.24 L$.  



<img src="C:\Users\yunswj\Desktop\mathmodel.assets\image-20211206183903240.png" alt="image-20211206183903240" style="zoom:33%;" />

## 模型求解 

在具体的求解方面引入 $CFD$ ，使用 $Fluent$ 求解。$Fluent$ 采用基于非结构网格的有限体积法进行计算，经过实验，在网格单元为 $0.18 0.15 0.12cm$ 的时候 ，进口处 $a$ 的速度和出口处 $b$ 的速度轮廓已经比较接近。在进口处已经分辨不出区别。考虑到单元格大小为 $0.12cm$ 的时候单元格比 $0.15$ 时要多出一倍，会导致计算量增大，最终选定单元格的网格大小为 $0.15cm$ 。  

### (1).求解基本方程组  

针对题中的流场要求，使用质量守恒的连续方程和动量守恒的动量方程。在判断管内的气体流动状态时，以雷诺数的大小来分辩。主管直径为 1.8cm，当进口最大速度时为 150cm/s ，出口压力为0，气体密度0.001225g/cm……2，气体的粘滞系数为0.0001789g/cm/s.此时：$$R _E = \frac{\rho v D}{\mu}=0.001225 \times 150 \times 1.80 /0.00017894 = 1848.38$$ 主管内的雷诺数已经接近湍流临界值。考虑到管内的流动在某些时刻可能会发展成湍流。  
针对题中的流场要求，使用质量守恒的连续方程和动量守恒的动量方程。在判断管内的气体流动状态时，以雷诺数的大小来分辩。主管直径为 1.8cm，当进口最大速度时为 150cm/s ，出口压力为0，气体密度0.001225g/cm……2，气体的粘滞系数为0.0001789g/cm/s.此时：$$R _E = \frac{\rho v D}{\mu}=0.001225 \times 150 \times 1.80 /0.00017894 = 1848.38$$ 主管内的雷诺数已经接近湍流临界值。考虑到管内的流动在某些时刻可能会发展成湍流。  
针对题中的流场要求，使用质量守恒的连续方程和动量守恒的动量方程。在判断管内的气体流动状态时，以雷诺数的大小来分辩。主管直径为 $1.8cm$，当进口最大速度时为 $150cm/s$ ，出口压力为 $0$ ，气体密度 $0.001225g/cm ^3$，气体的粘滞系数为 $0.0001789g/cm/s$ .  
此时：$$R _E = \frac{\rho v D}{\mu}=0.001225 \times 150 \times 1.80 /0.00017894 = 1848.38$$ 主管内的雷诺数已经接近湍流临界值。考虑到管内的流动在某些时刻可能会发展成湍流。  

### (2).湍流模型方程的选取  

使用 $Spalart-Almaras$ 湍流模型。  $$\frac{\partial}{\partial _t}(\rho \bar{v}) + \frac{\partial}{\partial _x{_i}}(\rho \bar{V} u _x{_i})=\frac{1}{\sigma _{\bar{v}}}\{{\frac{\partial}{\partial _X{_j}}}[(\mu + \rho \bar{v})]+\rho C_b{_2}(\frac{\partial \bar{u}}{\partial x _j})\}+G _v + Y _v$$  该方程为粘性系数的输移方程，式中 ：$\rho$ 为密度，$u _i$为紊动运动粘性系数,$\sigma ,C$为常数系数。$G _u$代表紊动粘性系数的产生项，$Y _u$代表壁面的阻碍而使紊动粘性系数减弱项，表达式分别为:$$G _v = \rho \bar{S} \bar{V} C {_b{_1}}$$  
$\bar{S}$ 综合了涡量和应变张量对紊动粘性系数的影响。 $$Y _u = \rho(\frac{\bar{v}}{d})^2f _ \omega C \omega _1$$ 紊动动力粘性系数 $\mu _1$ 为 $(\mu _1 = \rho \bar{v}f{_v{_1}})$ 其中 $f _v{_1} = \frac{x ^3}{x ^3 + C^3}$ $$\mu _1= \rho \bar{v}[\frac{(\frac{\bar{v}}{v})^3}{(\frac{\bar{v}}{v})^3+C ^3}]$$  以上式子中 $C _b{_1},C _b{_2},,C _v{_1},k$ 均为常数，其值为：$C _b{_1}=0.1335,C _b{_2}=0.622,C _v{_1}=7.1,C _\omega{_1}=\frac{C _b}{K ^2}+\frac{(1+C _b{_2})}{\sigma \bar{v}},C _\omega{_2}=0.3,C _\omega{_3}=2.0,k=0.4187$  

### (3).边界条件约束  
根据生理学资料，进口边界条件给平均部速度-定常计算；或给断面平均速度在一个呼吸周期内的变化函数-非定常计算。  

出口边界：给定相对压力值。本文定常和非定常一致，取 $0$.  
固壁边界：无滑移边界条件，流速取为 $0$.  

#### (4)常量因数设置  

$Air Density$：$0.001225$。  

$Viscosity$：$0.00017894$.  

松弛因子：$Pressure$  0.3，

$Density$为1，

$Body forces$为1，

$Momenturn$ 为 $0.7$ ，

$modified turbulenced$为$0.8$，

$Turbulent viscosity$ 为$1$；离散化时，压力为标准离散，压力-速度耦合采用 $SIMPLE$ 法离散。$Momenturn$ 和 $Modified turbulent$ 和 $viscosity$ 均为一阶上风。  

## 计算结果以及分析：

通过Fluent计算以下几种情况的气体流场计算：
1.圆管直接连接分叉四至四级以上以及完全过渡的气管树内流场定常计算。  
2.完全管端过渡光滑分叉至三级分的气管树内流场非定常计算。  
3.光滑分叉至四级的气管树内流场的非定常计算，比较分叉级数对前几级内的气体流动影响。     

为方便我们对模型的建立，这里我们可以选择几个部分的气道横截面的平面图，如同所示，$F1$ 表示 $Z$ 坐标为 $0$ 时的剖面。$F2$ 为对应的 $X$ 坐标为 $0$ 时的剖面，对应气管前后壁面上的剖面。现在我们对左支气管插入了，$L1，L2，L3，L4$共四个横截面，对右主支气管插入了 $R1，R2，R3$ 共三个横截面。

<img src="C:\Users\yunswj\Desktop\mathmodel.assets\image-20211206183708516.png" alt="image-20211206183708516" style="zoom:30%;" />

为简化模型及便于实际操作，这里我们对分叉处的管道连接采用了圆柱管直接连接的模型建立方法。我们从主气管入口到第四级肺支气管处进行建模，采用四面体网格自动划分。  
在定常情况下，由于人体每分钟通气量最少为 $3 L/min$（深度麻醉），最多可以超过 $100 L/min$（在运动中），在短时间内超过 $200L/min$（测定最大呼吸气量）。基于现在的医学研究，及实验的合理性，我们选取成年人的健康肺部入口主支气管的直径 $1.8 cm$，进口平均速度为 $50~1666 cm/s$。静息状态下每分钟呼吸 $12~18$ 次，进口速度取 $150cm/s$。为求得结果可以快速收敛，我们采用 $Spalart-Allmaras$ 湍流模型进行求解，共迭代了 $58$ 步。

通过对肺部空气流速分布的分析，可以知道由于右支气管与主支气管夹角小一些，右肺的空气流量要大于左肺的流量。基于进口平均速度为 $150 cm/s$ 的情况下，主管流场中的最大速度已经达到了 $180 cm/s$，通过主管流场的最大速度计算得出的雷诺数为 $2200$ ，已经非常接近湍流时的临界值 $2300$ 。而右支气管的气管中局部速度最高达到了 $220 cm/s$。


通过研究相关资料，发现，当连接处采用圆柱管直接连接时，由于左支气管与主气管夹角较大，吸气时气体从主气管经过后进行分流，在分流后的较长一段气管内存在明显的滞留区中产生了气流分离现象。这种情况不利于人体气管内的气体流动传输。而在变曲管过渡连接的模型中，二次流中出现一对旋转方向相反的涡，在直管连接的模型中，二次流上的速度分布则没有那么明显。

弯管过渡的三级分岔管模型非定常计算
目的是为研究一个呼吸周期内支气管内的气体流动状态。
边界条件
我们采用四面体网格，单元高度 $0.15cm$。正常人在平静状态下每分钟呼吸 $12~18$ 次，计算时取平均 $15$ 次，所以确定了一个周期为 $4.0s$ ，此时人的呼吸频率为 $0.25Hz$。取进口最大速度为 $150 cm/s$ 。根据现有生理学的研究数据表明，进口速度随时间的变化关系为 $v=150 \times \sin(2 \times \pi \times t/T)$，其中，$T=4 s$ 。其它边界条件同前所述。





# 问题二 

## 问题二分析

在第一问的流体模型的基础上考虑支气管在分叉处有半径为0.7cm肿物时的气体流动情况。假定在正常主支气管末端左，右支气管的分叉处长了一个直径为 $0.7cm$ 的球形异物。接着使用 $Fluent$ 进行建模计算。

<img src="C:\Users\yunswj\Desktop\mathmodel.assets\image-20211206190906904.png" alt="image-20211206190906904" style="zoom:33%;" />



## 计算

使用四面体单元划分网格，单元高度为 $0.15 cm$ ，总共的网格数目为 $106602$ 个。边界条件的设置同三级分叉管一直，进行非定常计算时，取呼吸周期为4秒，迭代时间步长为 $0.05s$ ,共迭代的次数为 $80$ 次。经过计算，气流速度最高达 $238cm/s$ .

## 结果分析

在一秒时刻出现最大的吸气流量时，通过对F1截面研究得出，在出现异常情况的部位，由于管道突然变小，在分岔管的两侧出现高速流体区域。在进气管道的速度相同的情况下，正常的支气管主管中的流速比产生病变的支气管中的气体流速要稍大，在离病变部位较远的位置，两者速度轮廓相近，但在病变位置附件，流态发生很大的变化。得出结论由于病变引起的两侧支气管狭小，从而使该部位的速度增大。病变的位置在气管的内侧，从主管分岔剧资管后，二次流方向速度偏向管壁外侧，使得支气管外侧壁所承受的剪切力大于管壁内侧。在子管内发展一段时间后。在远离破损处流动情况和以往一致。


# 问题三

改变呼吸的频率和强度，探讨气管树内的秋冬情况 





摘要：针对以往呼吸力学模型使用一个或若干非线性气阻元件不能描述整个气管-支气管树的弊端。本文通过肺部支气管树的解剖结构，以Golden三级气道模型为蓝本建立多腔室，非线性气道分级的呼吸力学集中参数模型，得出16~23级气管部位的阻力对气道阻力的贡献最大，并且与气管横截半径的4次方成。并建立了相应的肺支气管树空间非对称模型，使用计算流体力学软件Fluent进行数值求解，有目的的比较了气管的分叉处不同弯曲方式带来的影响以及划分不同网格对计算结果的影响。通过建立一个三叉气管树病变模型，得出在缺口处气流流速增加的
